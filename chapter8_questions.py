def get_chapter_8_questions():
    """Returns Chapter 8: Public-Key Certificate Management questions"""
    return {
        "section1": {
            "title": "Section 1: Multiple Choice (2 points each)",
            "questions": [
                {
                    "num": 1,
                    "question": "What is the primary purpose of a public-key certificate?",
                    "options": {
                        "A": "To encrypt data for transmission",
                        "B": "To associate a public key with an owner (the entity having the matching private key)",
                        "C": "To store private keys securely",
                        "D": "To generate new cryptographic keys"
                    },
                    "answer": "B",
                    "points": 2,
                    "explanation": "A public-key certificate is used to associate a public key with an owner (i.e., the entity having the matching private key, and ideally the only such entity). It binds a public key to a named Subject through a digital signature from a CA."
                },
                {
                    "num": 2,
                    "question": "Who generates the digital signature on a public-key certificate?",
                    "options": {
                        "A": "The certificate owner",
                        "B": "The relying party",
                        "C": "A trusted third party called a Certification Authority (CA)",
                        "D": "The web browser"
                    },
                    "answer": "C",
                    "points": 2,
                    "explanation": "The certificate is a data structure that binds a public key to a named Subject, by means of a digital signature generated by a trusted third party called a Certification Authority (CA)."
                },
                {
                    "num": 3,
                    "question": "What does the CA's signature on a certificate represent?",
                    "options": {
                        "A": "The CA's assertion that the Subject is trustworthy",
                        "B": "The CA's assertion that the public key belongs to the named Subject",
                        "C": "The CA's guarantee that the certificate will never be revoked",
                        "D": "The CA's verification of the Subject's financial status"
                    },
                    "answer": "B",
                    "points": 2,
                    "explanation": "The signature represents the CA's assertion that the public key belongs to the named Subject. A CA is vouching not for the character or integrity of the entity, but rather for an association between an entity name and a public key."
                },
                {
                    "num": 4,
                    "question": "In the X.509v3 certificate standard, what does the Serial-Number field specify?",
                    "options": {
                        "A": "The version of the certificate standard",
                        "B": "The owner's name",
                        "C": "A unique identifier for the certificate, used for revocation",
                        "D": "The public key algorithm"
                    },
                    "answer": "C",
                    "points": 2,
                    "explanation": "The Serial-Number field uniquely identifies the certificate, e.g., for revocation purposes."
                },
                {
                    "num": 5,
                    "question": "What does the Validity-Period field in an X.509v3 certificate specify?",
                    "options": {
                        "A": "The encryption algorithm validity",
                        "B": "The dates (Not-Before, Not-After) during which the certificate is valid",
                        "C": "The key length requirements",
                        "D": "The number of times the certificate can be used"
                    },
                    "answer": "B",
                    "points": 2,
                    "explanation": "The Validity-Period specifies dates (Not-Before, Not-After) during which the certificate is valid."
                },
                {
                    "num": 6,
                    "question": "Which certificate grade requires only demonstration of administrative control of a domain (e.g., ability to respond to admin@domain.com)?",
                    "options": {
                        "A": "Extended Validated (EV) Certificates",
                        "B": "Organization Validated (OV) Certificates",
                        "C": "Domain Validated (DV) Certificates",
                        "D": "Individual Validated (IV) Certificates"
                    },
                    "answer": "C",
                    "points": 2,
                    "explanation": "Domain Validated (DV) Certificates validate the Subject by demonstration of administrative control of the domain (e.g., ability to respond to domain account such as admin@domain.com). There is no assurance that the requested party is associated with any real-world entity."
                },
                {
                    "num": 7,
                    "question": "What is a characteristic of Domain Validated (DV) certificates?",
                    "options": {
                        "A": "They require extensive manual verification",
                        "B": "They are expensive and time-consuming to obtain",
                        "C": "Issuing them is inexpensive and usually fully-automated",
                        "D": "They provide assurance of real-world entity association"
                    },
                    "answer": "C",
                    "points": 2,
                    "explanation": "Issuing DV certificates is inexpensive and usually fully-automated. There is no assurance that the requested party is associated with any real-world entity."
                },
                {
                    "num": 8,
                    "question": "What additional verification does an Organization Validated (OV) certificate require compared to a DV certificate?",
                    "options": {
                        "A": "Only domain control verification",
                        "B": "Domain control plus manual checks confirming claimed organization business name and address",
                        "C": "Government database registration only",
                        "D": "Physical site inspection only"
                    },
                    "answer": "B",
                    "points": 2,
                    "explanation": "OV certificates require demonstration of domain control (like DV) and passing manual checks (e.g., confirmation of a claimed org. business name, address). The CA may cross-check claimed business name with a commercial database and call a publicly listed number."
                },
                {
                    "num": 9,
                    "question": "What motivated the creation of Extended Validated (EV) certificates?",
                    "options": {
                        "A": "The need for faster certificate issuance",
                        "B": "Loss of confidence after low-assurance DV certs emerged (e.g., DV cert for phishing website looking identical to a legit site)",
                        "C": "Government regulations requiring stronger certificates",
                        "D": "Technical limitations of existing certificate types"
                    },
                    "answer": "B",
                    "points": 2,
                    "explanation": "EV certificates were motivated by loss of confidence after low-assurance DV certs emerged (e.g., DV cert for phishing website looking identical to a legit site)."
                },
                {
                    "num": 10,
                    "question": "Which of the following is NOT verified by a CA before issuing an EV certificate?",
                    "options": {
                        "A": "The real-world existence of the legal entity named as Subject",
                        "B": "The requesting individual's identity and their authority to represent the org",
                        "C": "The financial solvency of the organization",
                        "D": "Exclusive control of the specified domain name"
                    },
                    "answer": "C",
                    "points": 2,
                    "explanation": "Before issuing an EV cert, the CA manually verifies: (1) real-world existence of the legal entity, (2) registration in gov-recognized databases, (3) physical/operational existence, (4) requesting individual's identity and authority, (5) exclusive domain control. Financial solvency is not verified."
                },
                {
                    "num": 11,
                    "question": "What is an Individual Validated (IV) certificate?",
                    "options": {
                        "A": "A certificate issued to individuals rather than organizations",
                        "B": "A certificate that a user has chosen to accept despite not being recognized by their client software's trust anchors",
                        "C": "A certificate with the highest level of validation",
                        "D": "A certificate issued by the browser vendor"
                    },
                    "answer": "B",
                    "points": 2,
                    "explanation": "Individual Validated (IV) Certificates are certs that a user has chosen to accept (e.g., self-signed certs) despite not being recognized by their client software's trust anchors."
                },
                {
                    "num": 12,
                    "question": "In certificate chain validation, what is an 'intermediate CA'?",
                    "options": {
                        "A": "A CA that only issues DV certificates",
                        "B": "A CA whose public key is certified by another CA (often a trust anchor)",
                        "C": "A CA that has been revoked",
                        "D": "A CA that only operates during business hours"
                    },
                    "answer": "B",
                    "points": 2,
                    "explanation": "A CA may issue a certificate for the public key of another CA, sometimes called an intermediate CA, e.g., when the first CA is a trust anchor or atop a hierarchy. This results in the concept of a certificate chain."
                },
                {
                    "num": 13,
                    "question": "Which of the following is NOT a step in certificate chain validation?",
                    "options": {
                        "A": "Checking that the certificate has not expired",
                        "B": "Verifying the certificate has not been revoked",
                        "C": "Confirming the certificate owner's credit score",
                        "D": "Verifying the signature mathematically using the signing CA's public key"
                    },
                    "answer": "C",
                    "points": 2,
                    "explanation": "Certificate chain validation includes checking expiration, revocation status, signature verification, trust in the signing CA, Subject matching, constraint compliance, and chain verification. Credit scores are not part of certificate validation."
                },
                {
                    "num": 14,
                    "question": "What is a 'trust anchor' in the context of PKI?",
                    "options": {
                        "A": "A physical device that stores certificates",
                        "B": "A CA public key relied on as a pre-trusted starting point for certificate chains",
                        "C": "A certificate that has been revoked",
                        "D": "The newest certificate in a chain"
                    },
                    "answer": "B",
                    "points": 2,
                    "explanation": "Trust anchors are CA public keys relied on as pre-trusted starting points for certificate chains. Some browsers have a trusted certificate store of self-signed certificates of a large number of established CAs vetted by browser vendors or OS."
                },
                {
                    "num": 15,
                    "question": "What is Trust On First Use (TOFU)?",
                    "options": {
                        "A": "When a certificate is validated through a complete chain verification",
                        "B": "When a self-signed certificate is accepted the first time it is received without any cross-check or assurance of authenticity",
                        "C": "When a CA verifies an organization's identity",
                        "D": "When a browser automatically renews an expired certificate"
                    },
                    "answer": "B",
                    "points": 2,
                    "explanation": "TOFU is when a self-signed certificate is accepted (relied on as 'trusted') the first time it is received from a remote party, without any cross-check or assurance that it is authentic. It is also called blind TOFU or leap-of-faith trust."
                },
                {
                    "num": 16,
                    "question": "TOFU is commonly used in which protocol configuration?",
                    "options": {
                        "A": "HTTPS with EV certificates",
                        "B": "SSH configured for authentication with user password and server public key",
                        "C": "TLS with mutual authentication",
                        "D": "S/MIME email encryption"
                    },
                    "answer": "B",
                    "points": 2,
                    "explanation": "TOFU is common when SSH is configured for authentication with user password and server public key. On first visit to an SSH server, the SSH client receives the server public key and is given an option to accept it."
                },
                {
                    "num": 17,
                    "question": "A CA is vouching for which of the following about the certificate Subject?",
                    "options": {
                        "A": "The character and moral integrity of the entity",
                        "B": "The financial stability of the entity",
                        "C": "The association between an entity name and a public key",
                        "D": "The technical competence of the entity"
                    },
                    "answer": "C",
                    "points": 2,
                    "explanation": "A CA is vouching not for the character or integrity of the entity named in the certificate, but rather for an association between an entity name and a public key."
                },
                {
                    "num": 18,
                    "question": "What check should a CA perform to verify that the requesting party knows the corresponding private key?",
                    "options": {
                        "A": "Request the private key directly",
                        "B": "Send a fresh challenge and verify the response using the public key while the requesting party uses the private key",
                        "C": "Ask for a password associated with the key",
                        "D": "Check the key in a public database"
                    },
                    "answer": "B",
                    "points": 2,
                    "explanation": "The requesting party should provide a proof of knowledge of the private key, e.g., by the CA sending a fresh challenge and verifying a response, wherein the CA uses the public key and the requesting party uses the private key."
                },
                {
                    "num": 19,
                    "question": "According to the slides, approximately how many root certificates appear in all three major browser trust stores (Microsoft, Mozilla, Apple)?",
                    "options": {
                        "A": "50 certificates",
                        "B": "123 certificates",
                        "C": "247 certificates",
                        "D": "432 certificates"
                    },
                    "answer": "B",
                    "points": 2,
                    "explanation": "According to the slides, 123 certificates appear in all three major trust stores (Microsoft, Mozilla, Apple)."
                },
                {
                    "num": 20,
                    "question": "What happens when a browser visits a website with a self-signed certificate?",
                    "options": {
                        "A": "The browser automatically accepts it as trusted",
                        "B": "The browser software may reject it, or present a dialogue allowing the user to accept it as 'trusted'",
                        "C": "The browser contacts the CA for verification",
                        "D": "The connection is automatically encrypted without any warning"
                    },
                    "answer": "B",
                    "points": 2,
                    "explanation": "A browser visiting a web site may be sent a self-signed certificate. The browser software may reject it, or present a dialogue allowing the user to accept it as 'trusted' despite the software not recognizing it as such."
                }
            ]
        },

        "section2": {
            "title": "Section 2: True/False (1 point each)",
            "questions": [
                {
                    "num": 21,
                    "question": "A relying party must trust the issuing CA and have the corresponding valid public key of that CA to verify a certificate's signature.",
                    "answer": "T",
                    "points": 1,
                    "explanation": "TRUE - Any party that relies on the certificate (any relying party) places their trust in the issuing CA, and requires the corresponding valid public key of that CA in order to verify this signature."
                },
                {
                    "num": 22,
                    "question": "Domain Validated (DV) certificates provide assurance that the requesting party is associated with a real-world entity.",
                    "answer": "F",
                    "points": 1,
                    "explanation": "FALSE - DV certificates have no assurance that the requested party is associated with any real-world entity. They only validate administrative control of the domain."
                },
                {
                    "num": 23,
                    "question": "Most end-users notice the difference between DV and OV certificates.",
                    "answer": "F",
                    "points": 1,
                    "explanation": "FALSE - Most end-users don't notice the difference between DV and OV certs, even though browsers may display org-related info to users for OV certificates."
                },
                {
                    "num": 24,
                    "question": "Self-signed certificates allow deriving trust in one public key from another.",
                    "answer": "F",
                    "points": 1,
                    "explanation": "FALSE - Self-signed certificates do not allow deriving trust in one public key from another, but serve as a convenient structure for packaging a public key and related attributes."
                },
                {
                    "num": 25,
                    "question": "Trust in a self-signed certificate should be established by a reliable out-of-band channel.",
                    "answer": "T",
                    "points": 1,
                    "explanation": "TRUE - Trust in a self-signed certificate should be established by a reliable out-of-band channel since the signature on a self-signed certificate doesn't provide third-party validation."
                },
                {
                    "num": 26,
                    "question": "In SSH with TOFU, on return visits to a server, the newly received public key is silently cross-checked with the stored key.",
                    "answer": "T",
                    "points": 1,
                    "explanation": "TRUE - On return visits to an SSH server, the newly received public key is (silently) cross-checked with the stored key."
                },
                {
                    "num": 27,
                    "question": "Many PKI tools are designed to require user involvement for every certificate validation after initial keys are set as trusted.",
                    "answer": "F",
                    "points": 1,
                    "explanation": "FALSE - Many PKI tools are designed to fully automate trust management after initial keys are set as trusted, proceeding thereafter without user involvement, silently using any keys or trust anchors accepted or configured in error."
                },
                {
                    "num": 28,
                    "question": "The Subject field in an X.509v3 certificate contains the owner's name.",
                    "answer": "T",
                    "points": 1,
                    "explanation": "TRUE - The Subject field in an X.509v3 certificate contains the owner's name."
                },
                {
                    "num": 29,
                    "question": "The Issuer field in an X.509v3 certificate contains the issuing CA's name.",
                    "answer": "T",
                    "points": 1,
                    "explanation": "TRUE - The Issuer field contains the issuing CA's name."
                },
                {
                    "num": 30,
                    "question": "For high-quality certificates, if an organization name is asserted, the CA should cross-check to confirm the requesting party is legitimately affiliated with the organization.",
                    "answer": "T",
                    "points": 1,
                    "explanation": "TRUE - For high-quality certificates, if an organization name is asserted, the CA should carry out cross-checks to confirm the requesting party is legitimately affiliated with, or authorized by the organization to acquire the pending certificate."
                },
                {
                    "num": 31,
                    "question": "Mozilla's root certificate store has about 95% overlap with Microsoft's store.",
                    "answer": "F",
                    "points": 1,
                    "explanation": "FALSE - Mozilla has 158 certificates with 10 unique to Mozilla (95% overlapping), but Microsoft has 432 certificates with 247 unique to MS. The overlap percentage refers to Mozilla's certificates being found in other stores, not vice versa."
                },
                {
                    "num": 32,
                    "question": "During certificate chain validation, the current date must be within the range [Not-Before, Not-After] of the certificate's validity period.",
                    "answer": "T",
                    "points": 1,
                    "explanation": "TRUE - Certificate validation includes checking that the certificate has not expired, and the current date is in the range [Not-Before, Not-After]."
                },
                {
                    "num": 33,
                    "question": "When validating a certificate chain, only the end-entity certificate needs to be checked for revocation.",
                    "answer": "F",
                    "points": 1,
                    "explanation": "FALSE - If not directly signed by a trust anchor CA, then a valid chain of certificates from a trust anchor to the target certificate must be available, with all validation steps checked for every certificate in the chain."
                },
                {
                    "num": 34,
                    "question": "TOFU is also called 'blind TOFU' or 'leap-of-faith' trust to emphasize the risk and lack of cross-check.",
                    "answer": "T",
                    "points": 1,
                    "explanation": "TRUE - To emphasize the risk, and lack of cross-check, TOFU is also called blind TOFU or leap-of-faith trust."
                },
                {
                    "num": 35,
                    "question": "An EV certificate requires verification that the requesting individual has the authority to represent the organization.",
                    "answer": "T",
                    "points": 1,
                    "explanation": "TRUE - Before issuing an EV cert, the CA manually verifies the requesting individual's identity and their authority to represent the org."
                }
            ]
        },

        "section3": {
            "title": "Section 3: Scenario-Based Questions (3 points each)",
            "questions": [
                {
                    "num": 36,
                    "question": "Alice is visiting a website for the first time and receives a certificate signed by 'Let's Encrypt'. Her browser shows a padlock icon and no warnings. Which type of certificate validation is most likely being used, and why?",
                    "options": {
                        "A": "TOFU - because it's her first visit to the site",
                        "B": "Certificate chain validation - because Let's Encrypt is a recognized CA in her browser's trust store",
                        "C": "Individual Validation - because she personally accepted the certificate",
                        "D": "Manual validation - because she verified the certificate fingerprint"
                    },
                    "answer": "B",
                    "points": 3,
                    "explanation": "This is certificate chain validation. Let's Encrypt is a recognized CA whose root certificate is in most browser trust stores. The browser validates the certificate chain from Let's Encrypt (intermediate CA) up to a trust anchor. This is NOT TOFU because TOFU specifically refers to accepting self-signed certificates without verification."
                },
                {
                    "num": 37,
                    "question": "Bob's company wants to obtain a certificate that displays the company name in the browser's address bar with extensive verification. They need to prove their legal existence, government registration, physical presence, and domain control. Which certificate type should they obtain?",
                    "options": {
                        "A": "Domain Validated (DV) Certificate",
                        "B": "Organization Validated (OV) Certificate",
                        "C": "Extended Validation (EV) Certificate",
                        "D": "Self-signed Certificate"
                    },
                    "answer": "C",
                    "points": 3,
                    "explanation": "An EV certificate requires all these verifications: (1) real-world existence of the legal entity, (2) registration in gov-recognized databases, (3) physical/operational existence matching the location indicated, (4) requesting individual's identity and authority, and (5) exclusive domain control."
                },
                {
                    "num": 38,
                    "question": "Charlie is setting up SSH access to a new development server. When he first connects, the SSH client displays the server's public key fingerprint and asks if he wants to continue connecting. He says 'yes' without verifying the fingerprint through any other channel. What trust model is Charlie using?",
                    "options": {
                        "A": "Certificate Authority trust model",
                        "B": "Web of Trust model",
                        "C": "Trust On First Use (TOFU) / Leap-of-faith trust",
                        "D": "Extended Validation trust model"
                    },
                    "answer": "C",
                    "points": 3,
                    "explanation": "This is TOFU (Trust On First Use), also called blind TOFU or leap-of-faith trust. Charlie accepted the server's public key on first use without any cross-check or assurance that it is authentic. This is common when SSH is configured for authentication with user password and server public key."
                },
                {
                    "num": 39,
                    "question": "A certificate for example.com is being validated. The certificate shows: Subject: example.com, Signed by: IntermediateCA, and IntermediateCA's certificate shows: Subject: IntermediateCA, Signed by: RootCA, where RootCA is in the browser's trust store. What is the correct order of signature verification?",
                    "options": {
                        "A": "Verify example.com signature first, then IntermediateCA, then RootCA",
                        "B": "Start with RootCA (self-signed trust anchor), use RootCA's public key to verify IntermediateCA's signature, then use IntermediateCA's public key to verify example.com's signature",
                        "C": "Only verify the RootCA signature since it's the trust anchor",
                        "D": "Randomly verify any certificate in the chain"
                    },
                    "answer": "B",
                    "points": 3,
                    "explanation": "Certificate chain validation starts with the trust anchor (RootCA). The RootCA is self-signed and pre-trusted. Its public key is used to verify the IntermediateCA certificate signature. Then the IntermediateCA's public key (now verified) is used to verify the end-entity certificate (example.com)."
                },
                {
                    "num": 40,
                    "question": "A phishing website obtains a DV certificate for 'g00gle-login.com' (with zeros instead of 'o's). The certificate is properly issued and valid. Why does this represent a limitation of the DV certificate system?",
                    "options": {
                        "A": "DV certificates cannot be issued for domain names with numbers",
                        "B": "DV certificates only verify domain control, not whether the domain is legitimate or associated with a real-world entity",
                        "C": "DV certificates are not trusted by browsers",
                        "D": "DV certificates cannot use HTTPS"
                    },
                    "answer": "B",
                    "points": 3,
                    "explanation": "DV certificates only validate administrative control of the domain. There is no assurance that the requested party is associated with any real-world entity. This was the motivation for EV certificates - loss of confidence after low-assurance DV certs emerged (e.g., DV cert for phishing website looking identical to a legit site)."
                }
            ]
        },

        "section4": {
            "title": "Section 4: Short Answer (2 points each)",
            "questions": [
                {
                    "num": 41,
                    "question": "What does CA stand for in the context of public-key certificates?",
                    "answer": ["certification authority", "certificate authority", "ca"],
                    "points": 2,
                    "type": "text",
                    "explanation": "CA stands for Certification Authority (or Certificate Authority), the trusted third party that generates digital signatures on certificates to bind public keys to named Subjects."
                },
                {
                    "num": 42,
                    "question": "What does PKI stand for?",
                    "answer": ["public key infrastructure", "pki"],
                    "points": 2,
                    "type": "text",
                    "explanation": "PKI stands for Public Key Infrastructure, which is the framework for managing public-key certificates and their lifecycle."
                },
                {
                    "num": 43,
                    "question": "What does DV stand for in the context of certificate grades?",
                    "answer": ["domain validated", "domain validation", "dv"],
                    "points": 2,
                    "type": "text",
                    "explanation": "DV stands for Domain Validated, a certificate grade that only requires demonstration of administrative control of a domain."
                },
                {
                    "num": 44,
                    "question": "What does EV stand for in the context of certificate grades?",
                    "answer": ["extended validation", "extended validated", "ev"],
                    "points": 2,
                    "type": "text",
                    "explanation": "EV stands for Extended Validation, the highest grade of certificate requiring extensive manual verification of the organization."
                },
                {
                    "num": 45,
                    "question": "What does TOFU stand for in the context of certificate trust?",
                    "answer": ["trust on first use", "tofu"],
                    "points": 2,
                    "type": "text",
                    "explanation": "TOFU stands for Trust On First Use, when a self-signed certificate is accepted the first time it is received without verification."
                },
                {
                    "num": 46,
                    "question": "Name TWO checks a CA should perform before issuing a certificate (separate with comma):",
                    "answer": ["private key", "proof of knowledge", "domain control", "domain name", "email", "phone", "organization", "natural-world", "cross-check"],
                    "points": 2,
                    "type": "multi_text",
                    "explanation": "CAs should check: (1) Evidence of knowledge of the corresponding private key, (2) Evidence of ownership or control of computer-addressable identities (domain, email, phone), (3) Confirmation of asserted natural-world names for high-quality certificates."
                },
                {
                    "num": 47,
                    "question": "Name TWO fields found in an X.509v3 certificate (separate with comma):",
                    "answer": ["version", "serial", "issuer", "validity", "subject", "public key", "extension", "signature", "algorithm"],
                    "points": 2,
                    "type": "multi_text",
                    "explanation": "X.509v3 certificate fields include: Version, Serial-Number, Issuer, Validity-Period, Subject, Public-Key info, extension fields (optional), Signature-Algorithm, and Digital-Signature."
                },
                {
                    "num": 48,
                    "question": "What is another name for 'blind TOFU' that emphasizes the risk involved?",
                    "answer": ["leap of faith", "leap-of-faith", "leapoffaith"],
                    "points": 2,
                    "type": "text",
                    "explanation": "Blind TOFU is also called leap-of-faith trust to emphasize the risk and lack of cross-check when accepting a self-signed certificate on first use."
                },
                {
                    "num": 49,
                    "question": "What certificate type is a 'self-signed certificate' where the Issuer and Subject are the same?",
                    "answer": ["trust anchor", "root", "root certificate", "self-signed"],
                    "points": 2,
                    "type": "text",
                    "explanation": "Self-signed certificates are signed by the private key corresponding to the certificate's own public key. When pre-trusted in a browser's store, they serve as trust anchors or root certificates."
                },
                {
                    "num": 50,
                    "question": "What field in an X.509v3 certificate contains the owner's name?",
                    "answer": ["subject", "subject field"],
                    "points": 2,
                    "type": "text",
                    "explanation": "The Subject field in an X.509v3 certificate contains the owner's name."
                }
            ]
        }
    }